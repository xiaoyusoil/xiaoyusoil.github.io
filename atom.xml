<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>生鱼忧患</title>
  
  <subtitle>网络安全&amp;软件开发</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2020-05-20T13:26:12.683Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>真小鱼</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>安全架构</title>
    <link href="http://yoursite.com/2020/05/20/%E5%AE%89%E5%85%A8%E6%9E%B6%E6%9E%84/"/>
    <id>http://yoursite.com/2020/05/20/%E5%AE%89%E5%85%A8%E6%9E%B6%E6%9E%84/</id>
    <published>2020-05-20T13:26:12.000Z</published>
    <updated>2020-05-20T13:26:12.683Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>&#39;SPM维护&#39;</title>
    <link href="http://yoursite.com/2020/05/18/SPM%E7%BB%B4%E6%8A%A4/"/>
    <id>http://yoursite.com/2020/05/18/SPM%E7%BB%B4%E6%8A%A4/</id>
    <published>2020-05-18T11:36:45.000Z</published>
    <updated>2020-05-25T05:58:00.058Z</updated>
    
    <content type="html"><![CDATA[<h2 id="软件项目管理"><a href="#软件项目管理" class="headerlink" title="软件项目管理"></a>软件项目管理</h2><h3 id="实验—LRR维护"><a href="#实验—LRR维护" class="headerlink" title="实验—LRR维护"></a>实验—LRR维护</h3><h4 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h4><p>1.安装wampserver集成服务器组件（Apache+PHP+Mysql/MariaDB）。</p><p>2.phpmyadmin新建lrr数据库并导入sql文件，两个sql文件任选其一。</p><p>3.安装HBuilderX或PhpStorm，进行必要的配置。</p><p>4.打开LRR即为成功。</p><img src="/2020/05/18/SPM%E7%BB%B4%E6%8A%A4/image-20200518221332226.png" class title="This is an image"><h4 id="维护流程"><a href="#维护流程" class="headerlink" title="维护流程"></a>维护流程</h4><p>1.明确bug，运行时错误，团队成员的名字在一组中多次出现。</p><img src="/2020/05/18/SPM%E7%BB%B4%E6%8A%A4/image-20200518221343243.png" class title="This is an image"><blockquote><p><a href="http://118.25.96.118/bugzilla/show_bug.cgi?id=57" target="_blank" rel="noopener">http://118.25.96.118/bugzilla/show_bug.cgi?id=57</a></p><p>Hui Lan 2020-03-15 13:55:57 CST</p><p><a href="http://118.25.96.118/bugzilla/show_bug.cgi?id=57" target="_blank" rel="noopener">Repeated names in a course group</a></p><p>QWQ- Leader : 陆博业(201732120119)<br>Zhou Xianlong-201732120130 (Joined)<br>陆博业-201732120119 (Created)<br>吕伊豪-201732120120 (Joined)<br>郑可富-201732120129 (Joined)<br>郑可富-201732120129 (Joined)<br>郑可富-201732120129 (Joined)<br>郑可富-201732120129 (Joined)<br>郑可富-201732120129 (Joined)</p></blockquote><p>2.修改Script.php文件中的connection为本地root连接。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;$con&#x3D;mysqli_connect(&quot;localhost&quot;,&quot;Teecloudy&quot;,&quot;5q7Ol2e!#!&quot;,&quot;lrr&quot;);</span><br><span class="line">$con&#x3D;mysqli_connect(&quot;localhost&quot;,&quot;root&quot;,&quot;&quot;,&quot;lrr&quot;);</span><br></pre></td></tr></table></figure><p>3.因为此bug是学生端创建组问题，因此以学生身份登录，UserType=Student。</p><p>4.问题复现。</p><ul><li>创建Group，遇到的问题。</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">TypeError:$(...).dialog is not a function</span><br><span class="line">&#x2F;&#x2F;没有添加jquery-ui.css和jquery-ui.js</span><br><span class="line">TypeError: r.getClientRects is not a function</span><br><span class="line">&#x2F;&#x2F;添加的jquery-ui的版本为1.10.4导致此问题，更新为最新的1.12.1就显示正常了</span><br></pre></td></tr></table></figure><ul><li>重复邀请好友，还原到问题根本。</li></ul><img src="/2020/05/18/SPM%E7%BB%B4%E6%8A%A4/image-20200520005825475.png" class title="This is an image"><img src="/2020/05/18/SPM%E7%BB%B4%E6%8A%A4/image-20200520141050255.png" class title="This is an image"><ul><li>猜测是系统没有判断该好友是否已加入队伍，好像很好修复，加个判断就行，那就来试一下。</li></ul><p>5.代码审计。</p><ul><li>定位到邀请好友模块。该页面处于Course.php中。</li></ul><img src="/2020/05/18/SPM%E7%BB%B4%E6%8A%A4/image-20200520140322816.png" class title="This is an image"><img src="/2020/05/18/SPM%E7%BB%B4%E6%8A%A4/image-20200520140538458.png" class title="This is an image"><ul><li>表单传递到Script.php中处理。</li></ul><img src="/2020/05/18/SPM%E7%BB%B4%E6%8A%A4/image-20200520140803714.png" class title="This is an image"><p>该Invite Group Request模块并未在插入数据之前检查这条数据的合理性（是否重复包含）。</p><p>在获取student_id后直接插入数据表course_group_members_table。</p><p>6.解决方法。在插入之前先查询，比较之后再执行sql语句。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$result &#x3D; mysqli_query($con,&quot;SELECT * FROM course_group_members_table where Course_Group_id &#x3D; &#39;$groupid&#39; and Student_ID &#x3D; &#39;$student_id&#39;&quot;);</span><br><span class="line">if(mysqli_num_rows($result)&gt;0)&#123;</span><br><span class="line">$_SESSION[&quot;info_ReMarking&quot;]&#x3D;&quot;This student has already been invited&quot;;</span><br><span class="line">header(&quot;Location: Course.php?url&#x3D;&quot;.$url);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">$sql&#x3D;&quot;INSERT INTO &#96;course_group_members_table&#96;( &#96;Course_Group_id&#96;, &#96;Student_ID&#96;, &#96;Status&#96;) VALUES ($groupid,$student_id,&#39;Invited&#39;)&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>该if-else语句首先查询数据库中是否存在要添加的student_id，若返回结果集中行的数量大于0，则表示已存在该student_id，那么重定向到当前页面；否则执行添加student_id的sql语句。</p><p>注意：把数据库表course_groups_table和course_group_members_table中重复的student_id数据先手动删除，否则mysqli_num_rows()返回值会大于0。</p><p>7.关于旧版和新版引申出的新bug。</p><p>我在旧版的基础上进行了修改，也保证了我的修改准确无误。</p><p>因为LRR更新了新版，因此我也在新版上进行了测试，但是我发现了一个问题（这样的问题可能不止我发现的这一处）。</p><p>我在添加成员后发现，course_group_members_table数据表的添加没有问题，course_groups_table中成员的student_id未添加。</p><img src="/2020/05/18/SPM%E7%BB%B4%E6%8A%A4/Snipaste_2020-05-25_12-58-32.png" class title="This is an image"><img src="/2020/05/18/SPM%E7%BB%B4%E6%8A%A4/Snipaste_2020-05-25_12-58-54.png" class title="This is an image"><p>以下是旧版部分代码截图：</p><img src="/2020/05/18/SPM%E7%BB%B4%E6%8A%A4/Snipaste_2020-05-25_12-51-50.png" class title="This is an image"><p>以下是新版部分代码截图：</p><img src="/2020/05/18/SPM%E7%BB%B4%E6%8A%A4/Snipaste_2020-05-25_12-51-15.png" class title="This is an image"><p>可以发现新版LRR删除了部分代码，那部分被删除的代码刚好导致了这个原因，因此我重新添加了原来的代码，并修改了错误的title为原版的“Invite Group Request and add a new member into the database”。</p><p>8.验证测试。</p><img src="/2020/05/18/SPM%E7%BB%B4%E6%8A%A4/Snipaste_2020-05-25_13-54-30.png" class title="This is an image"><img src="/2020/05/18/SPM%E7%BB%B4%E6%8A%A4/Snipaste_2020-05-25_13-54-41.png" class title="This is an image"><img src="/2020/05/18/SPM%E7%BB%B4%E6%8A%A4/Snipaste_2020-05-25_13-54-53.png" class title="This is an image"><img src="/2020/05/18/SPM%E7%BB%B4%E6%8A%A4/Snipaste_2020-05-25_13-55-05.png" class title="This is an image"><img src="/2020/05/18/SPM%E7%BB%B4%E6%8A%A4/Snipaste_2020-05-25_13-55-24.png" class title="This is an image"><img src="/2020/05/18/SPM%E7%BB%B4%E6%8A%A4/Snipaste_2020-05-25_13-55-37.png" class title="This is an image"><img src="/2020/05/18/SPM%E7%BB%B4%E6%8A%A4/Snipaste_2020-05-25_13-55-48.png" class title="This is an image"><p>因youtube、youku、bilibili等上传视频需实名认证和审核，所以录像上传至百度网盘。</p><p>链接：<a href="https://pan.baidu.com/s/1zbWNkLSf6g_iBh7j9I6-lQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1zbWNkLSf6g_iBh7j9I6-lQ</a><br>提取码：qwrj</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;软件项目管理&quot;&gt;&lt;a href=&quot;#软件项目管理&quot; class=&quot;headerlink&quot; title=&quot;软件项目管理&quot;&gt;&lt;/a&gt;软件项目管理&lt;/h2&gt;&lt;h3 id=&quot;实验—LRR维护&quot;&gt;&lt;a href=&quot;#实验—LRR维护&quot; class=&quot;headerlink&quot; 
      
    
    </summary>
    
    
    
      <category term="SPM" scheme="http://yoursite.com/tags/SPM/"/>
    
  </entry>
  
</feed>
